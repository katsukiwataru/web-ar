var THREEx=THREEx||{};THREEx.ArPatternFile={},THREEx.ArPatternFile.toCanvas=function(t,e){console.assert(!1,"not yet implemented")},THREEx.ArPatternFile.encodeImageURL=function(t,e){var a=new Image;a.onload=function(){var t=THREEx.ArPatternFile.encodeImage(a);e(t)},a.src=t},THREEx.ArPatternFile.encodeImage=function(t){var e=document.createElement("canvas"),a=e.getContext("2d");e.width=16,e.height=16;for(var i="",r=0;r>-2*Math.PI;r-=Math.PI/2){a.save(),a.clearRect(0,0,e.width,e.height),a.translate(e.width/2,e.height/2),a.rotate(r),a.drawImage(t,-e.width/2,-e.height/2,e.width,e.height),a.restore();var n=a.getImageData(0,0,e.width,e.height);0!==r&&(i+="\n");for(var h=2;h>=0;h--)for(var d=0;d<n.height;d++){for(var l=0;l<n.width;l++){0!==l&&(i+=" ");var o=d*n.width*4+4*l+h,c=n.data[o];i+=String(c).padStart(3)}i+="\n"}}return i},THREEx.ArPatternFile.triggerDownload=function(t,e="pattern-marker.patt"){var a=window.document.createElement("a");a.href=window.URL.createObjectURL(new Blob([t],{type:"text/plain"})),a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)},THREEx.ArPatternFile.buildFullMarker=function(t,e,a,i,r){var n=.1+(1-e)/2*.8,h=document.createElement("canvas"),d=h.getContext("2d");h.width=h.height=a,d.fillStyle="white",d.fillRect(0,0,h.width,h.height),d.fillStyle=i,d.fillRect(.1*h.width,.1*h.height,.8*h.width,.8*h.height),d.fillStyle="white",d.fillRect(n*h.width,n*h.height,h.width*(1-2*n),h.height*(1-2*n));var l=document.createElement("img");l.addEventListener("load",function(){d.drawImage(l,n*h.width,n*h.height,h.width*(1-2*n),h.height*(1-2*n));var t=h.toDataURL();r(t)}),l.src=t};
